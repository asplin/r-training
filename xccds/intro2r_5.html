<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- jQuery -->
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
  
  <!-- highlight.js -->
  <link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/vs.min.css">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
  <script src="http://yandex.st/highlightjs/7.3/languages/r.min.js"></script>
  
  <!-- bootstrap -->
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" id="style" media="screen">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
  
  <!-- bootstrap-responsive -->
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" media="screen">
  
  <!-- tocify -->
  <link rel="stylesheet" href="http://gregfranko.com/jquery.tocify.js/css/jquery.tocify.css">
  <script src="http://gregfranko.com/jquery.tocify.js/js/jquery.tocify.min.js"></script>
  
  <!-- fancybox -->
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.css">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.js"></script>
  
  <script>
  
  /* run scripts when document is ready */
  $(function() {
  
    /* size of thumbnails */
    var thumbsize = "span4";
  
    /* included languages */
    var languages = {};
  
    /* Add div wrapping class to code blocks without them */
    $('pre code').each(function(){
  
      var block_type, code_type;
      /* output block */
      if($(this).hasClass('')){
        block_type = "output";
        code_type = "";
      }
      /* source code block */
      else{
        block_type = "source";
        code_type = $(this).attr('class');
      }
      /* no wrapping div, not using render_html(), so add to wrap */
      if($(this).closest('div').length < 1){
        $(this).parent().wrap('<div class="' + [block_type, code_type].join(" ") + '"></div>');
      }
      /* just add code type to the parent div */
      else{
        $(this).closest('div').addClass(code_type);
      }
    });
  
    /* style tables, set them as output*/
    $('table').addClass('table table-striped table-bordered table-hover table-condensed')
      .wrap('<div class="output", style="overflow: auto"/>');
  
    /* find all code or output blocks which have a class and add toggle */
    $('div.source, div.output').each(function() {
      var button = $('<button class="btn-mini btn-link btn toggle " data-toggle="button">+/- </button>');
  
      /* code block */
      if($(this).hasClass('source')){
        var code_block = $(this).find('code');
        var lang_type = code_block.attr('class');
        button.text(button.text() + lang_type + ' Code');
        button.addClass('source ' + lang_type);
        languages[lang_type]=1;
        code_block.each(function(i, e) {
          hljs.highlightBlock(e);
        });
      }
  
      /* output block */
      else {
        button.text(button.text() + 'Output');
        button.addClass('output active');
      }
      $(this).before(button);
    });
  
    /* syntax highlight code blocks*/
  
    /* onclick toggle next code block */
    $('.toggle').click(function() {
      $(this).button('toggle');
      $(this).next('div').slideToggle();
      return false;
    });
  
    /* give images a fancybox and thumbnail classes to allow lightbox and thumbnails TODO: make fancybox prev next if grouped */
    $('p').each(function(){
      $(this).find('img').unwrap().wrapAll('<div class="row-fluid"><div class="rimage thumbnails"></div></div>');
    });
    $('div.rimage').children('img').wrap('<a href="#", class="' + thumbsize + ' thumbnail"></a></li>').addClass('fancybox');
  
    /* fancybox */
    $(".fancybox").each( function() {
      var img = $(this);
      $(this).fancybox({
        beforeLoad: function(){
          <!--img.removeClass('thumbnail');-->
        },
        afterClose: function(){
          <!--img.addClass('thumbnail');-->
          img.css('display', 'block');
        },
      });
    });
  
    /* add bootstrap classes */
    $('body').wrapInner('<div class="container-fluid"><div class="row-fluid"><div class="span9">');
    $('.container-fluid >.row-fluid').prepend('<div class="span3"><div id="toc"></div></div>');
  
    create_language_links = function(){
      var text='';
      for(language in languages){
        text += '<li><a href="#" class="source toggle_global btn-link btn" type="source.' + language + '">' + language + '</a></li>\n';
      }
      return text;
    }
  
    /* add navbar */
    $('.container-fluid').prepend(
      '<div id="bottom-navbar" class="navbar-fixed-bottom navbar">\
        <div class="navbar-inner">\
          <div class="pull-right">\
            <span class="navbar-text">Toggle</span>\
            <div class="btn-group dropup" data-toggle="button-checkbox">\
              <button type="source" class="toggle_global btn">Code</button>\
              <button class="btn dropdown-toggle" data-toggle="dropdown">\
                <span class="caret"></span>\
              </button>\
              <ul class="dropdown-menu pull-right">' 
                + create_language_links() + 
              '</div>\
              <button type="output" class="toggle_global btn active">Output</button>\
              <button type="thumbnails" class="toggle_global btn active">Plots</button>\
            </div>\
          </div>\
        </div>\
      </div>'
    );
  
    /* global toggles FIXME explicitly toggle all on/off using global variables */
    $('.toggle_global').click(function(){
      $(this).button('toggle');
      var type = $(this).attr('type');
      $('.' + type).button('toggle');
      $('div.' + type).slideToggle();
      return false;
    });
  
    /* toggle code blocks hidden by default */
    $('div.source').toggle();
  
    /* add table of contents */
    $('#toc').tocify({extendPage: false});
  
    /* if using render_html() hook, make functions links to custom R search */
    /*search in ggplot documentation or inside-r.org */
    $("span.functioncall").replaceWith(function(){
  
      return '<a target="_blank" href="http://www.google.com/search?sourceid=navclient&gfns=1&\
  q=site:docs.ggplot2.org/current OR site:inside-r.org ' +
      $(this).text() + '">' + $(this).text()+'</a>'
    });
  
    /* add footer */
    $('body').wrapInner('<div id="wrap" />');
    $('body').append('<div id="push" />');
    var p = $('p:contains("Author:")');
    var last_p = p.filter(':last');
    p.detach();
    last_p.addClass('muted').attr('id','credit');
    last_p.append('<p>styled with <a href="https://github.com/jimhester/knitr_bootstrap">knitr_bootstrap</a></p>');
    last_p.appendTo("body");
    last_p.wrap('<div id="footer"><div class="container" /></div>');
  });
  </script>
  
  <style type="text/css">
  
  /* Knitr_bootstrap styles
  -------------------------------------------------- */
  .container-fluid {
    padding-left: 0 !important;
  }
  
  .toggle{
    text-transform: capitalize;
  }
  
  .toggle_global{
    text-transform: capitalize;
  }
  
  .thumbnails { text-align:center; }
  .thumbnails > .thumbnail { display: inline-block !important; float: none !important; }
  
  /* Sticky footer styles
  -------------------------------------------------- */
  * {
    margin:0;
  }
  html,
  body {
      height: 100%;
      /* The html and body elements cannot have any padding or margin. */
  }
  
  /* Wrapper for page content to push down footer */
  #wrap {
      min-height: 100%;
      height: auto !important;
      height: 100%;
      /* Negative indent footer by it's height */
      margin: 0 auto -60px;
  }
  
  /* Set the fixed height of the footer here */
  #push,
  #footer {
      height: 60px;
      padding-bottom: 60px;
  }
  
  #footer {
    text-align: center;
  }
  
  /* Twitter Bootstrap Overrides */
  /* -------------------------------------------------- */
  .nav-list > li > a, .nav-list .nav-header {
      margin: 0px !important;
  }
  .nav-list > li > a {
      padding: 5px !important;
  }
  
  /* Tocify */
  /* -------------------------------------------------- */
  
  /* Display h2 headers */
  .sub-header {
    display: block;
  }
  
  /* Hide the rest */
  .sub-header .sub-header {
    display: none;
  }
  
   /* Indent h4 elements */
  .sub-header .sub-header .sub-header .sub-header {
    text-indent: 50px;
  }
  
  </style>
  
  <link rel="stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" id="style" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css" id="style" title="default" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/amelia/bootstrap.min.css" title="amelia" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/cerulean/bootstrap.min.css" title="cerulean" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/cosmo/bootstrap.min.css" title="cosmo" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/cyborg/bootstrap.min.css" title="cyborg" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/journal/bootstrap.min.css" title="journal" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/readable/bootstrap.min.css" title="readable" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/simplex/bootstrap.min.css" title="simplex" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/slate/bootstrap.min.css" title="slate" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/spacelab/bootstrap.min.css" title="spacelab" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/spruce/bootstrap.min.css" title="spruce" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/superhero/bootstrap.min.css" title="superhero" media="screen">
  <link rel="alternate stylesheet" type="text/css" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/united/bootstrap.min.css" title="united" media="screen">
  
  <script>
  $(function() {
      $('#bottom-navbar').find('.navbar-inner').append(
      '<ul class="nav">\
        <li class="dropdown">\
          <a class="dropdown-toggle" role="button" data-toggle="dropdown" href="#">选择网页样式</a>\
          <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\
            <li><a class="style-switch" id="default" href="#">default</a></li>\
            <li><a class="style-switch" id="amelia" href="#">amelia</a></li>\
            <li><a class="style-switch" id="cerulean" href="#">cerulean</a></li>\
            <li><a class="style-switch" id="cosmo" href="#">cosmo</a></li>\
            <li><a class="style-switch" id="cyborg" href="#">cyborg</a></li>\
            <li><a class="style-switch" id="journal" href="#">journal</a></li>\
            <li><a class="style-switch" id="readable" href="#">readable</a></li>\
            <li><a class="style-switch" id="simplex" href="#">simplex</a></li>\
            <li><a class="style-switch" id="slate" href="#">slate</a></li>\
            <li><a class="style-switch" id="spacelab" href="#">spacelab</a></li>\
            <li><a class="style-switch" id="spruce" href="#">spruce</a></li>\
            <li><a class="style-switch" id="superhero" href="#">superhero</a></li>\
            <li><a class="style-switch" id="united" href="#">united</a></li>\
          </ul>\
        </li>\
      </ul>');
      $('.style-switch').click(function(){
        var css = $('link[title=' + $(this).attr('id') + ']');
        $('#style[rel=stylesheet]').attr('href', css.attr('href'));
        return false;
      });
    }
  );
  </script>
  
  <link id="code-style" rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/vs.min.css">
  <link rel="alternate stylesheet" title="Default" href="http://yandex.st/highlightjs/7.3/styles/default.min.css">
  <link rel="alternate stylesheet" title="Dark" href="http://yandex.st/highlightjs/7.3/styles/dark.min.css">
  <link rel="alternate stylesheet" title="FAR" href="http://yandex.st/highlightjs/7.3/styles/far.min.css">
  <link rel="alternate stylesheet" title="IDEA" href="http://yandex.st/highlightjs/7.3/styles/idea.min.css">
  <link rel="alternate stylesheet" title="Sunburst" href="http://yandex.st/highlightjs/7.3/styles/sunburst.min.css">
  <link rel="alternate stylesheet" title="Zenburn" href="http://yandex.st/highlightjs/7.3/styles/zenburn.min.css">
  <link rel="alternate stylesheet" title="Visual Studio" href="http://yandex.st/highlightjs/7.3/styles/vs.min.css">
  <link rel="alternate stylesheet" title="Ascetic" href="http://yandex.st/highlightjs/7.3/styles/ascetic.min.css">
  <link rel="alternate stylesheet" title="Magula" href="http://yandex.st/highlightjs/7.3/styles/magula.min.css">
  <link rel="alternate stylesheet" title="GitHub" href="http://yandex.st/highlightjs/7.3/styles/github.min.css">
  <link rel="alternate stylesheet" title="Google Code" href="http://yandex.st/highlightjs/7.3/styles/googlecode.min.css">
  <link rel="alternate stylesheet" title="Brown Paper" href="http://yandex.st/highlightjs/7.3/styles/brown_paper.min.css">
  <link rel="alternate stylesheet" title="School Book" href="http://yandex.st/highlightjs/7.3/styles/school_book.min.css">
  <link rel="alternate stylesheet" title="IR Black" href="http://yandex.st/highlightjs/7.3/styles/ir_black.min.css">
  <link rel="alternate stylesheet" title="Solarized - Dark" href="http://yandex.st/highlightjs/7.3/styles/solarized_dark.min.css">
  <link rel="alternate stylesheet" title="Solarized - Light" href="http://yandex.st/highlightjs/7.3/styles/solarized_light.min.css">
  <link rel="alternate stylesheet" title="Arta" href="http://yandex.st/highlightjs/7.3/styles/arta.min.css">
  <link rel="alternate stylesheet" title="Monokai" href="http://yandex.st/highlightjs/7.3/styles/monokai.min.css">
  <link rel="alternate stylesheet" title="XCode" href="http://yandex.st/highlightjs/7.3/styles/xcode.min.css">
  <link rel="alternate stylesheet" title="Pojoaque" href="http://yandex.st/highlightjs/7.3/styles/pojoaque.min.css">
  <link rel="alternate stylesheet" title="Rainbow" href="http://yandex.st/highlightjs/7.3/styles/rainbow.min.css">
  <link rel="alternate stylesheet" title="Tomorrow" href="http://yandex.st/highlightjs/7.3/styles/tomorrow.min.css">
  <link rel="alternate stylesheet" title="Tomorrow Night" href="http://yandex.st/highlightjs/7.3/styles/tomorrow-night.min.css">
  <link rel="alternate stylesheet" title="Tomorrow Night Bright" href="http://yandex.st/highlightjs/7.3/styles/tomorrow-night-bright.min.css">
  <link rel="alternate stylesheet" title="Tomorrow Night Blue" href="http://yandex.st/highlightjs/7.3/styles/tomorrow-night-blue.min.css">
  <link rel="alternate stylesheet" title="Tomorrow Night Eighties" href="http://yandex.st/highlightjs/7.3/styles/tomorrow-night-eighties.min.css">
  
  <script>
  $(function() {
      $('#bottom-navbar').find('.navbar-inner').append(
      '<ul class="nav">\
        <li class="dropdown">\
          <a class="dropdown-toggle" role="button" data-toggle="dropdown" href="#">选择代码风格</a>\
          <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\
            <li><a class="code-style-switch" title="Default" href="#">Default</a></li>\
            <li><a class="code-style-switch" title="Dark" href="#">Dark</a></li>\
            <li><a class="code-style-switch" title="FAR" href="#">FAR</a></li>\
            <li><a class="code-style-switch" title="IDEA" href="#">IDEA</a></li>\
            <li><a class="code-style-switch" title="Sunburst" href="#">Sunburst</a></li>\
            <li><a class="code-style-switch" title="Zenburn" href="#">Zenburn</a></li>\
            <li><a class="code-style-switch" title="Visual Studio" href="#">Visual Studio</a></li>\
            <li><a class="code-style-switch" title="Ascetic" href="#">Ascetic</a></li>\
            <li><a class="code-style-switch" title="Magula" href="#">Magula</a></li>\
            <li><a class="code-style-switch" title="GitHub" href="#">GitHub</a></li>\
            <li><a class="code-style-switch" title="Google Code" href="#">Google Code</a></li>\
            <li><a class="code-style-switch" title="Brown Paper" href="#">Brown Paper</a></li>\
            <li><a class="code-style-switch" title="School Book" href="#">School Book</a></li>\
            <li><a class="code-style-switch" title="IR Black" href="#">IR Black</a></li>\
            <li><a class="code-style-switch" title="Solarized - Dark" href="#">Solarized - Dark</a></li>\
            <li><a class="code-style-switch" title="Solarized - Light" href="#">Solarized - Light</a></li>\
            <li><a class="code-style-switch" title="Arta" href="#">Arta</a></li>\
            <li><a class="code-style-switch" title="Monokai" href="#">Monokai</a></li>\
            <li><a class="code-style-switch" title="XCode" href="#">XCode</a></li>\
            <li><a class="code-style-switch" title="Pojoaque" href="#">Pojoaque</a></li>\
            <li><a class="code-style-switch" title="Rainbow" href="#">Rainbow</a></li>\
            <li><a class="code-style-switch" title="Tomorrow" href="#">Tomorrow</a></li>\
            <li><a class="code-style-switch" title="Tomorrow Night" href="#">Tomorrow Night</a></li>\
            <li><a class="code-style-switch" title="Tomorrow Night Bright" href="#">Tomorrow Night Bright</a></li>\
            <li><a class="code-style-switch" title="Tomorrow Night Blue" href="#">Tomorrow Night Blue</a></li>\
            <li><a class="code-style-switch" title="Tomorrow Night Eighties" href="#">Tomorrow Night Eighties</a></li>\
          </ul>\
        </li>\
      </ul>');
      $('.code-style-switch').click(function(){
        var css = $('link[title="' + $(this).attr('title') + '"]');
        $('#code-style[rel=stylesheet]').attr('href', css.attr('href'));
  
        return false;
      });
  });
  </script>
  
  
  <style type="text/css">
  
   /* customize style */
  body{font-size:18px; line-height: 30px}
  h1{font-size: 32px}
  h2{font-size: 26px}
  code, pre{font-size: 18px}
  a.code-style-switch{font-size: 14px}
  </style>
</head>
<body>
<h1 id="r语言基础入门之五简单线性回归">R语言基础入门之五：简单线性回归</h1>
<p>线性回归可能是数据分析中最为常用的工具了，如果你认为手上的数据存在着线性定量关系，不妨先画个散点图观察一下，然后用线性回归加以分析。下面简单介绍一下如何在R中进行线性回归。</p>
<h2 id="回归建模">1 回归建模</h2>
<p>我们利用R语言中内置的trees数据，其中包含了Volume（体积）、Girth（树围）、Height（树高）这三个变量，我们希望以体积为因变量，树围为自变量进行线性回归。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Volume~Girth,<span class="dt">data=</span>trees,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
model=<span class="kw">lm</span>(Volume~Girth,<span class="dt">data=</span>trees)
<span class="kw">abline</span>(model,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">summary</span>(model)</code></pre>
<p>首先绘制了两变量的散点图，然后用lm函数建立线性回归模型，并将回归直线加在原图上，最后用summary将模型结果进行了展示，从变量P值和F统计量可得回归模型是显著的。但截距项不应该为负数，所以也可以用下面方法将截距强制为0。</p>
<pre class="sourceCode r"><code class="sourceCode r">model2=<span class="kw">lm</span>(Volume~Girth<span class="dv">-1</span>,<span class="dt">data=</span>trees)</code></pre>
<h2 id="模型诊断">2 模型诊断</h2>
<p>在模型建立后会利用各种方式来检验模型的正确性，对残差进行分析是常见的方法，下面我们来生成四种用于模型诊断的图形。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">plot</span>(model)
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </code></pre>
<div class="figure">
<img src="figure/Rplot.jpeg" />
</div>
<p>这里左上图是残差对拟合值作图，整体呈现出一种先下降后下升的模式，显示残差中可能还存在未提炼出来的影响因素。右上图残差QQ图，用以观察残差是否符合正态分布。左下图是标准化残差对拟合值，用于判断模型残差是否等方差。右下图是标准化残差对杠杆值，虚线表示的cooks距离等高线。我们发现31号样本有较大的影响。</p>
<h2 id="变量变换">3 变量变换</h2>
<p>因为31号样本有着高影响力，为了降低其影响，一种方法就是将变量进行开方变换来改善回归结果，从残差标准误到残差图，各项观察都说明变换是有效的。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">sqrt</span>(Volume)~Girth,<span class="dt">data=</span>trees,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
model2=<span class="kw">lm</span>(<span class="kw">sqrt</span>(Volume)~Girth,<span class="dt">data=</span>trees)
<span class="kw">abline</span>(model2,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">summary</span>(model2)</code></pre>
<h2 id="模型预测">4 模型预测</h2>
<p>下面根据上述模型计算预测值以及置信区间，predict函数可以获得模型的预测值，加入参数可以得到预测区间</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">sqrt</span>(Volume)~Girth,<span class="dt">data=</span>trees,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
model2=<span class="kw">lm</span>(<span class="kw">sqrt</span>(Volume)~Girth,<span class="dt">data=</span>trees)
data.pre=<span class="kw">data.frame</span>(<span class="kw">predict</span>(model2,<span class="dt">interval=</span><span class="st">&#39;prediction&#39;</span>))
<span class="kw">lines</span>(data.pre$lwr~trees$Girth,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(data.pre$upr~trees$Girth,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</code></pre>
<div class="figure">
<img src="figure/Rplot01.jpeg" />
</div>
<p>我们还可以将树围和树高都加入到模型中去，进行多元回归。如果要考虑的变量很多，可以用step函数进行变量筛选，它是以AIC作为评价指标来判断一个变量是否应该加入模型，建议使用这种自动判断函数时要谨慎。对于嵌套模型，还可以使用anova建立方差分析表来比较模型。对于变量变换的形式，则可以使用MASS扩展包中的boxcox函数来进行COX变换。</p>
</body>
</html>
